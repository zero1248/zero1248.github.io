---
title: 逆波兰表达式
tags:
  - 算法
date: 2019-09-27 23:16:01
---

---

逆波兰表达式，即后缀表达式，常用于表达式求值中。相应的波兰表达式为前缀表达式。

后缀表达式的特点是事先考虑运算符的优先级，运算符在操作数之后，不需要处理括号。

正常的表达式为中缀表达式，可以通过几种方式由中缀表达式得到后缀表达式。

<!--more-->

---

### 笔算

##### 方法一：

① 将两个直接操作数用括号括起来；

② 将操作符提到括号后；

③ 去掉括号。

例如：

​	1+3*2-6/2：

① ((1+(3*2))-(6/2))

② ((1(32)*)+(62)/)-

③ 132*+62/-

即 1+3**2-6/2 → 132*+62/-

使用这种方法还可得到前缀表达式，即在第 ② 步将操作符提到括号前。

##### 方法二：

写出表达式树（编程实现时，常用后缀表达式生成表达式树），然而进行后序遍历即可得到后缀表达式。

表达式树的特点是所有操作数都位于叶子结点上，所有的叶子结点的数据都是操作数，操作符位于分支结点上。

例如：

​	A+B*(C-D)-E/F：

<img src="https://i.loli.net/2019/09/27/5Nw6RGC8vAZ3tFE.png" alt="123.png" style="zoom: 67%;" />

经过后序遍历得到：ABCD-*+EF/-



---

### 程序算法

从左到右遍历中缀表达式：

① 遇到操作数时就输出，加入后缀表达式；

② 遇到操作符时：

- 若为 '('，入栈
- 若为 ')'，则依次把栈中的运算符加入后缀表达式，直到出现 '('，从栈中直接删除 '('
- 若为除括号外的其他操作符，当其优先级高于除 '(' 以外的栈顶运算符时，直接入栈。否则从栈顶开始，依次弹出比当前处理的操作符优先级高和优先级相等的操作符，直到一个比它优先级低的或遇到了一个左括号为止

③ 遍历结束后，栈中剩下的操作符依次出栈加入后缀表达式。



根据以上原则，可以用数字对栈内和栈外的操作符优先级进行排序：

| 操作符 |  #   |  (   | *，/ | +，- |  )   |
| :----: | :--: | :--: | :--: | :--: | :--: |
|  isp   |  0   |  1   |  5   |  3   |  6   |
|  isp   |  0   |  6   |  4   |  2   |  1   |

其中，isp 表示栈内优先（in stack priority），icp 表示栈外优先（in coming priority）。

在表达式之后加上符号 '#' 表示表达式结束，相应地，在遍历表达式之前，先入栈一个 '#'。